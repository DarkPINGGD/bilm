<script>
const PASSWORD = "1234";

const pass = document.getElementById("pass");
const panel = document.getElementById("panel");

let records = JSON.parse(localStorage.getItem("records")) || [];
let levels  = JSON.parse(localStorage.getItem("levels")) || [];

function login(){
  if(pass.value !== PASSWORD){
    alert("Wrong password");
    return;
  }

  panel.innerHTML = `
    <h2>Pending Records</h2>
    ${
      records.map((r,i)=>`
        <div class="card">
          <b>${r.nick}</b> â€” ${r.levelName} (${r.progress}%)
          <br>
          <a href="${r.yt}" target="_blank">YouTube</a> |
          <a href="${r.raw}" target="_blank">Raw</a>
          <br><br>
          ${r.approved ? "APPROVED" : `
            <button class="approve" onclick="approve(${i})">Approve</button>
            <button class="reject" onclick="reject(${i})">Reject</button>
          `}
        </div>
      `).join("")
    }

    <h2>Add Level</h2>
    <input id="levelId" placeholder="Level ID">
    <input id="levelName" placeholder="Level Name">
    <input id="levelCreator" placeholder="Creator">
    <button class="add" onclick="addLevel()">Add Level</button>
  `;
}

function approve(i){
  records[i].approved = true;
  localStorage.setItem("records", JSON.stringify(records));
  location.reload();
}

function reject(i){
  records.splice(i,1);
  localStorage.setItem("records", JSON.stringify(records));
  location.reload();
}

function addLevel(){
  const id = document.getElementById("levelId").value;
  const name = document.getElementById("levelName").value;
  const creator = document.getElementById("levelCreator").value;

  if(!id || !name || !creator){
    alert("All fields required");
    return;
  }

  levels.push({ id, name, creator });
  localStorage.setItem("levels", JSON.stringify(levels));
  alert("Level added!");
}
</script>
